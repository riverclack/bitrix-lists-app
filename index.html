<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Scanner</title>
    <script src="https://api.bitrix24.com/api/v1/"></script>
    <style>body{font-family:monospace;padding:20px;}</style>
</head>
<body>
    <h3>Сканирование полей файлов...</h3>
    <div id="log">Ждите...</div>
    <script>
        BX24.init(function() {
            var html = "";
            var ids = [55, 57, 59]; // ID ваших списков
            
            BX24.callBatch({
                list55: ['lists.field.get', { IBLOCK_TYPE_ID: 'lists', IBLOCK_ID: 55 }],
                list57: ['lists.field.get', { IBLOCK_TYPE_ID: 'lists', IBLOCK_ID: 57 }],
                list59: ['lists.field.get', { IBLOCK_TYPE_ID: 'lists', IBLOCK_ID: 59 }]
            }, function(res) {
                // Функция поиска полей типа 'F' (File)
                function findFiles(data, listName) {
                    html += `<h3>Список ${listName}</h3>`;
                    for (var key in data) {
                        var f = data[key];
                        // Ищем поля, похожие на файлы (PROPERTY_...)
                        if (key.indexOf('PROPERTY_') === 0) {
                             html += `<b>Имя:</b> ${f.NAME} <br>`;
                             html += `<b>Код API (FIELD_ID):</b> ${f.FIELD_ID} <br>`;
                             html += `<b>Настоящий ID:</b> ${f.ID} <br>`;
                             html += `<b>ДЛЯ ССЫЛКИ НУЖНО:</b> PROPERTY_${f.ID} <br>`;
                             html += `<hr>`;
                        }
                    }
                }

                if(res.list55.data()) findFiles(res.list55.data(), "55 (Договоры)");
                if(res.list57.data()) findFiles(res.list57.data(), "57 (Спецификации)");
                if(res.list59.data()) findFiles(res.list59.data(), "59 (Заказы)");

                document.getElementById('log').innerHTML = html;
            });
        });
    </script>
</body>
</html>
